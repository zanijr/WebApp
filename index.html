<!DOCTYPE html>

<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Family Chores</title>

```
<!-- React and dependencies -->
<script src="https://unpkg.com/react@18/umd/react.development.js"></script>
<script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
<script src="https://cdn.tailwindcss.com"></script>

<!-- PWA Configuration -->
<meta name="theme-color" content="#6366F1">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<meta name="apple-mobile-web-app-title" content="Family Chores">
<meta name="msapplication-TileColor" content="#6366F1">

<!-- App Icons -->
<link rel="apple-touch-icon" sizes="180x180" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTgwIiBoZWlnaHQ9IjE4MCIgdmlld0JveD0iMCAwIDE4MCAxODAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxODAiIGhlaWdodD0iMTgwIiByeD0iMzIiIGZpbGw9IiM2MzY2RjEiLz4KPHN2ZyB4PSI0NSIgeT0iNDUiIHdpZHRoPSI5MCIgaGVpZ2h0PSI5MCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9IndoaXRlIiBzdHJva2Utd2lkdGg9IjIuNSIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIj4KPHBhdGggZD0ibTE2IDYgNiAxNCIvPgo8cGF0aCBkPSJNMTIgNkg4YTIgMiAwIDAgMC0yIDJ2NyIvPgo8cGF0aCBkPSJNMjAgMTNINHYtMmEyIDIgMCAwIDEgMi0yaDQiLz4KPHN2Zz4KPC9zdmc+">

<!-- Web App Manifest -->
<link rel="manifest" href="./manifest.json">

<style>
    /* PWA specific styles */
    * {
        -webkit-tap-highlight-color: transparent;
        -webkit-touch-callout: none;
        -webkit-user-select: none;
        user-select: none;
    }
    
    input, textarea, select {
        -webkit-user-select: text;
        user-select: text;
    }
    
    body {
        overscroll-behavior: none;
        -webkit-overflow-scrolling: touch;
    }
    
    .safe-area {
        padding-top: env(safe-area-inset-top);
        padding-bottom: env(safe-area-inset-bottom);
        padding-left: env(safe-area-inset-left);
        padding-right: env(safe-area-inset-right);
    }
    
    .vibrate {
        animation: vibrate 0.3s;
    }
    
    @keyframes vibrate {
        0%, 100% { transform: translateX(0); }
        25% { transform: translateX(-2px); }
        75% { transform: translateX(2px); }
    }
    
    .slide-up {
        animation: slideUp 0.3s ease-out;
    }
    
    @keyframes slideUp {
        from { transform: translateY(100%); opacity: 0; }
        to { transform: translateY(0); opacity: 1; }
    }
    
    .fade-in {
        animation: fadeIn 0.5s ease-in;
    }
    
    @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
    }
    
    .pulse-button {
        animation: pulse 2s infinite;
    }
    
    @keyframes pulse {
        0%, 100% { transform: scale(1); }
        50% { transform: scale(1.05); }
    }
    
    /* Custom scrollbar for webkit */
    ::-webkit-scrollbar {
        width: 4px;
    }
    
    ::-webkit-scrollbar-track {
        background: #f1f1f1;
    }
    
    ::-webkit-scrollbar-thumb {
        background: #6366F1;
        border-radius: 2px;
    }
    
    /* Loading spinner */
    .spinner {
        border: 3px solid #f3f3f3;
        border-top: 3px solid #6366F1;
        border-radius: 50%;
        width: 30px;
        height: 30px;
        animation: spin 1s linear infinite;
    }
    
    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }
    
    /* Touch feedback */
    .touch-feedback:active {
        transform: scale(0.95);
        transition: transform 0.1s;
    }
    
    /* Notification styles */
    .notification {
        position: fixed;
        top: 20px;
        right: 20px;
        background: #10B981;
        color: white;
        padding: 12px 16px;
        border-radius: 8px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        z-index: 1000;
        animation: slideIn 0.3s ease-out;
    }
    
    @keyframes slideIn {
        from { transform: translateX(100%); }
        to { transform: translateX(0); }
    }
    
    /* Status bar fix for iOS */
    @supports (padding: max(0px)) {
        .ios-safe-top {
            padding-top: max(20px, env(safe-area-inset-top));
        }
    }
</style>
```

</head>
<body class="bg-gray-50">
    <div id="root"></div>

```
<!-- Install banner -->
<div id="install-banner" class="hidden fixed bottom-0 left-0 right-0 bg-indigo-600 text-white p-4 z-50">
    <div class="flex items-center justify-between">
        <div>
            <p class="font-medium">Install Family Chores</p>
            <p class="text-sm opacity-90">Add to home screen for best experience</p>
        </div>
        <div class="flex gap-2">
            <button id="install-btn" class="bg-white text-indigo-600 px-4 py-2 rounded-lg font-medium">
                Install
            </button>
            <button id="dismiss-btn" class="text-white/80">
                ✕
            </button>
        </div>
    </div>
</div>

<script type="text/babel">
    const { useState, useEffect, useRef } = React;
    
    const ChoreApp = () => {
        const [currentUser, setCurrentUser] = useState(null);
        const [users, setUsers] = useState([
            { id: 1, name: 'Mom', role: 'parent', email: 'mom@family.com' },
            { id: 2, name: 'Dad', role: 'parent', email: 'dad@family.com' },
            { id: 3, name: 'Emma', role: 'child', email: 'emma@family.com', earnings: 0 },
            { id: 4, name: 'Jake', role: 'child', email: 'jake@family.com', earnings: 0 },
            { id: 5, name: 'Lily', role: 'child', email: 'lily@family.com', earnings: 0 }
        ]);
        
        const [lastAssignedChildIndex, setLastAssignedChildIndex] = useState(-1);
        const [activeView, setActiveView] = useState('login');
        const [isOnline, setIsOnline] = useState(navigator.onLine);
        const [notification, setNotification] = useState(null);
        const [loading, setLoading] = useState(false);
        
        const [chores, setChores] = useState([
            {
                id: 1,
                title: 'Clean Kitchen',
                description: 'Wipe counters, load dishwasher, sweep floor',
                reward: { type: 'money', amount: 10 },
                requiresPhoto: true,
                createdBy: 1,
                status: 'available',
                currentAssignee: null,
                assignmentStartTime: null,
                acceptanceTimer: 5,
                completionTimer: { enabled: false, duration: 0, penalty: 0 },
                reductionSettings: { enabled: false, amount: 0 },
                scheduledFor: null,
                originalReward: 10,
                firstAssigneeId: null,
                currentReward: 10,
                completedTasks: [],
                submissions: [],
                isRecurring: false,
                recurringType: 'daily',
                recurringDays: [],
                lastRecurredDate: null,
                completionStartTime: null
            },
            {
                id: 2,
                title: 'Take Out Trash',
                description: 'Empty all trash cans and take bins to curb',
                reward: { type: 'screen_time', amount: 30 },
                requiresPhoto: false,
                createdBy: 2,
                status: 'pending_acceptance',
                currentAssignee: 3,
                assignmentStartTime: Date.now() - (2 * 60 * 1000), // 2 minutes ago
                acceptanceTimer: 10,
                completionTimer: { enabled: true, duration: 30, penalty: 5 },
                reductionSettings: { enabled: true, amount: 5 },
                scheduledFor: null,
                originalReward: 30,
                firstAssigneeId: 3,
                currentReward: 30,
                completedTasks: [],
                submissions: [],
                isRecurring: false,
                recurringType: 'daily',
                recurringDays: [],
                lastRecurredDate: null,
                completionStartTime: null
            }
        ]);
        
        const children = users.filter(u => u.role === 'child');
        
        // Vibration function
        const vibrate = (pattern = [100]) => {
            if ('vibrate' in navigator) {
                navigator.vibrate(pattern);
            }
        };
        
        // Show notification
        const showNotification = (message, type = 'success') => {
            setNotification({ message, type });
            setTimeout(() => setNotification(null), 3000);
        };
        
        // PWA Installation
        useEffect(() => {
            let deferredPrompt;
            
            const handleBeforeInstallPrompt = (e) => {
                e.preventDefault();
                deferredPrompt = e;
                document.getElementById('install-banner').classList.remove('hidden');
            };
            
            const handleInstallClick = async () => {
                if (deferredPrompt) {
                    deferredPrompt.prompt();
                    const { outcome } = await deferredPrompt.userChoice;
                    if (outcome === 'accepted') {
                        showNotification('App installed successfully! 🎉');
                    }
                    deferredPrompt = null;
                    document.getElementById('install-banner').classList.add('hidden');
                }
            };
            
            const handleDismissClick = () => {
                document.getElementById('install-banner').classList.add('hidden');
            };
            
            window.addEventListener('beforeinstallprompt', handleBeforeInstallPrompt);
            document.getElementById('install-btn')?.addEventListener('click', handleInstallClick);
            document.getElementById('dismiss-btn')?.addEventListener('click', handleDismissClick);
            
            return () => {
                window.removeEventListener('beforeinstallprompt', handleBeforeInstallPrompt);
                document.getElementById('install-btn')?.removeEventListener('click', handleInstallClick);
                document.getElementById('dismiss-btn')?.removeEventListener('click', handleDismissClick);
            };
        }, []);
        
        // Network status monitoring
        useEffect(() => {
            const handleOnline = () => {
                setIsOnline(true);
                showNotification('Back online! 🟢');
            };
            const handleOffline = () => {
                setIsOnline(false);
                showNotification('You\'re offline 🔴', 'warning');
            };
            
            window.addEventListener('online', handleOnline);
            window.addEventListener('offline', handleOffline);
            
            return () => {
                window.removeEventListener('online', handleOnline);
                window.removeEventListener('offline', handleOffline);
            };
        }, []);
        
        // Timer management
        useEffect(() => {
            const interval = setInterval(() => {
                setChores(prevChores => 
                    prevChores.map(chore => {
                        // Check acceptance timer expiration
                        if (chore.status === 'pending_acceptance' && chore.assignmentStartTime) {
                            const elapsed = Date.now() - chore.assignmentStartTime;
                            if (elapsed >= chore.acceptanceTimer * 60 * 1000) {
                                return assignNextChild(chore);
                            }
                        }
                        return chore;
                    })
                );
            }, 1000);
            
            return () => clearInterval(interval);
        }, []);
        
        // Request notification permission
        const requestNotificationPermission = async () => {
            if ('Notification' in window && Notification.permission === 'default') {
                const permission = await Notification.requestPermission();
                if (permission === 'granted') {
                    showNotification('Notifications enabled! 🔔');
                }
            }
        };
        
        const assignNextChild = (chore) => {
            const availableChildren = children.filter(child => 
                !chore.completedTasks.some(task => task.childId === child.id)
            );
            
            if (availableChildren.length === 0) {
                // All children have been offered, cycle back to first assignee
                if (chore.firstAssigneeId) {
                    let newReward = chore.currentReward;
                    
                    if (chore.reductionSettings.enabled) {
                        newReward = Math.max(
                            chore.currentReward - chore.reductionSettings.amount,
                            Math.ceil(chore.originalReward * 0.1)
                        );
                    }
                    
                    return {
                        ...chore,
                        completedTasks: [],
                        currentAssignee: chore.firstAssigneeId,
                        assignmentStartTime: null,
                        status: 'auto_accepted',
                        currentReward: newReward,
                        completionStartTime: chore.completionTimer.enabled ? Date.now() : null
                    };
                }
            }
            
            const currentIndex = availableChildren.findIndex(child => child.id === chore.currentAssignee);
            const nextIndex = (currentIndex + 1) % availableChildren.length;
            
            return {
                ...chore,
                currentAssignee: availableChildren[nextIndex].id,
                assignmentStartTime: Date.now(),
                status: 'pending_acceptance'
            };
        };
        
        const getNextChildToAssign = () => {
            const nextIndex = (lastAssignedChildIndex + 1) % children.length;
            return children[nextIndex];
        };
        
        const startChoreAssignment = (choreId) => {
            const nextChild = getNextChildToAssign();
            
            setChores(prevChores =>
                prevChores.map(chore =>
                    chore.id === choreId
                        ? {
                            ...chore,
                            currentAssignee: nextChild.id,
                            firstAssigneeId: nextChild.id,
                            assignmentStartTime: Date.now(),
                            status: 'pending_acceptance',
                            currentReward: chore.originalReward
                        }
                        : chore
                )
            );
            
            setLastAssignedChildIndex(children.findIndex(child => child.id === nextChild.id));
            
            // Send notification to assigned child
            if ('Notification' in window && Notification.permission === 'granted') {
                new Notification('New Chore Assigned! 🎯', {
                    body: `${nextChild.name}, you have a new chore waiting!`,
                    icon: '/icon-192x192.png',
                    badge: '/icon-192x192.png',
                    tag: 'chore-assignment'
                });
            }
            
            vibrate([200, 100, 200]);
            showNotification(`Chore assigned to ${nextChild.name}! 🎯`);
        };
        
        const acceptChore = (choreId) => {
            setLoading(true);
            
            setTimeout(() => {
                setChores(prevChores =>
                    prevChores.map(chore =>
                        chore.id === choreId
                            ? {
                                ...chore,
                                assignmentStartTime: null,
                                status: 'assigned',
                                completionStartTime: chore.completionTimer.enabled ? Date.now() : null
                            }
                            : chore
                    )
                );
                
                setLoading(false);
                vibrate([100]);
                showNotification('Chore accepted! Let\'s get started! 💪');
            }, 500);
        };
        
        const declineChore = (choreId) => {
            setChores(prevChores =>
                prevChores.map(chore =>
                    chore.id === choreId ? assignNextChild(chore) : chore
                )
            );
            
            vibrate([50, 50, 50]);
            showNotification('Chore passed to next kid 👋');
        };
        
        const submitChoreCompletion = (choreId, hasPhoto = false) => {
            const submission = {
                id: Date.now(),
                childId: currentUser.id,
                choreId,
                timestamp: Date.now(),
                hasPhoto,
                status: 'pending_approval'
            };
            
            setChores(prevChores =>
                prevChores.map(chore =>
                    chore.id === choreId
                        ? {
                            ...chore,
                            submissions: [...chore.submissions, submission],
                            status: 'pending_approval',
                            completionStartTime: null
                        }
                        : chore
                )
            );
            
            vibrate([200]);
            showNotification('Chore submitted for approval! 🎉');
        };
        
        const getAcceptanceTimeRemaining = (assignmentStartTime, acceptanceTimer) => {
            const elapsed = Date.now() - assignmentStartTime;
            const remaining = Math.max(0, acceptanceTimer * 60 * 1000 - elapsed);
            const minutes = Math.floor(remaining / 60000);
            const seconds = Math.floor((remaining % 60000) / 1000);
            return `${minutes}:${seconds.toString().padStart(2, '0')}`;
        };
        
        const getTotalEarnings = (childId) => {
            return chores.reduce((total, chore) => {
                const childTasks = chore.completedTasks?.filter(task => task.childId === childId) || [];
                return total + childTasks.reduce((sum, task) => sum + task.reward, 0);
            }, 0);
        };
        
        // Login View
        if (activeView === 'login') {
            return (
                <div className="min-h-screen bg-gradient-to-br from-indigo-500 via-purple-500 to-pink-500 flex flex-col justify-center items-center p-4 safe-area">
                    {/* Notification */}
                    {notification && (
                        <div className={`notification ${notification.type === 'warning' ? 'bg-orange-500' : 'bg-green-500'}`}>
                            {notification.message}
                        </div>
                    )}
                    
                    {/* Offline Banner */}
                    {!isOnline && (
                        <div className="w-full max-w-sm mb-4 bg-red-500/90 backdrop-blur-sm rounded-lg p-3 text-white text-center slide-up">
                            <p className="text-sm font-medium">📱 Offline Mode</p>
                            <p className="text-xs opacity-90">Some features limited</p>
                        </div>
                    )}
                    
                    <div className="bg-white/95 backdrop-blur-lg rounded-3xl shadow-2xl p-8 w-full max-w-sm fade-in">
                        <div className="text-center mb-8">
                            <div className="w-24 h-24 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-full flex items-center justify-center mx-auto mb-6 shadow-xl">
                                <svg className="w-12 h-12 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2.5} d="m16 6 6 14" />
                                    <path d="M12 6H8a2 2 0 0 0-2 2v7" />
                                    <path d="M20 13H4v-2a2 2 0 0 1 2-2h4" />
                                </svg>
                            </div>
                            <h1 className="text-3xl font-bold text-gray-900 mb-2">Family Chores</h1>
                            <p className="text-gray-600">Choose your profile to continue</p>
                        </div>
                        
                        <div className="space-y-4">
                            {users.map(user => (
                                <button
                                    key={user.id}
                                    onClick={() => {
                                        vibrate([50]);
                                        setCurrentUser(user);
                                        setActiveView(user.role === 'parent' ? 'parent_dashboard' : 'child_dashboard');
                                        requestNotificationPermission();
                                    }}
                                    className="w-full p-4 text-left rounded-2xl border-2 border-gray-200 hover:border-indigo-400 hover:bg-indigo-50 transition-all touch-feedback"
                                >
                                    <div className="flex items-center">
                                        <div className={`w-14 h-14 rounded-full flex items-center justify-center mr-4 text-lg font-bold shadow-lg ${
                                            user.role === 'parent' 
                                                ? 'bg-gradient-to-br from-emerald-400 to-emerald-600 text-white' 
                                                : 'bg-gradient-to-br from-blue-400 to-blue-600 text-white'
                                        }`}>
                                            {user.name[0]}
                                        </div>
                                        <div>
                                            <div className="font-semibold text-gray-900 text-lg">{user.name}</div>
                                            <div className="text-sm text-gray-500 capitalize flex items-center">
                                                {user.role}
                                                {user.role === 'parent' ? ' 👨‍👩‍👧‍👦' : ' 🧒'}
                                            </div>
                                        </div>
                                    </div>
                                </button>
                            ))}
                        </div>
                        
                        <div className="mt-6 text-center">
                            <p className="text-xs text-gray-400">Pull down to refresh • Tap to select</p>
                        </div>
                    </div>
                </div>
            );
        }
        
        // Child Dashboard
        if (activeView === 'child_dashboard') {
            const myPendingChores = chores.filter(chore => 
                chore.currentAssignee === currentUser.id && chore.status === 'pending_acceptance'
            );
            const myActiveChores = chores.filter(chore => 
                chore.currentAssignee === currentUser.id && (chore.status === 'assigned' || chore.status === 'auto_accepted')
            );
            const myEarnings = getTotalEarnings(currentUser.id);
            
            return (
                <div className="min-h-screen bg-gradient-to-br from-purple-50 via-pink-50 to-blue-50 safe-area">
                    {/* Notification */}
                    {notification && (
                        <div className={`notification ${notification.type === 'warning' ? 'bg-orange-500' : 'bg-green-500'}`}>
                            {notification.message}
                        </div>
                    )}
                    
                    {/* Header */}
                    <div className="bg-white/90 backdrop-blur-sm shadow-lg p-6 sticky top-0 z-10 ios-safe-top">
                        <div className="flex justify-between items-center mb-4">
                            <div>
                                <h1 className="text-2xl font-bold text-gray-900 flex items-center">
                                    Hi, {currentUser.name}! 
                                    <span className="ml-2 text-3xl">👋</span>
                                </h1>
                                <p className="text-gray-600">Ready to earn some rewards?</p>
                            </div>
                            <div className="text-right">
                                <p className="text-sm text-gray-600">Total Earnings</p>
                                <p className="text-2xl font-bold text-green-600">${myEarnings}</p>
                            </div>
                        </div>
                        
                        <button
                            onClick={() => {
                                vibrate([50]);
                                setActiveView('login');
                            }}
                            className="w-full bg-gradient-to-r from-gray-500 to-gray-600 text-white py-3 rounded-xl hover:from-gray-600 hover:to-gray-700 touch-feedback font-medium"
                        >
                            Switch User
                        </button>
                    </div>

                    <div className="p-4 space-y-6">
                        {/* Pending Acceptance */}
                        {myPendingChores.length > 0 && (
                            <div className="slide-up">
                                <h2 className="text-xl font-bold text-gray-900 mb-4 flex items-center">
                                    Chores Waiting for You! 
                                    <span className="ml-2 pulse-button">🔔</span>
                                </h2>
                                {myPendingChores.map(chore => (
                                    <div key={chore.id} className="bg-white rounded-2xl shadow-xl p-6 border-2 border-purple-200 mb-4 relative overflow-hidden">
                                        {/* Animated background */}
                                        <div className="absolute inset-0 bg-gradient-to-r from-purple-50 to-pink-50 opacity-50"></div>
                                        
                                        <div className="relative z-10">
                                            <div className="flex justify-between items-start mb-4">
                                                <div className="flex-1">
                                                    <h3 className="text-xl font-bold text-gray-900 mb-1">{chore.title}</h3>
                                                    <p className="text-gray-600">{chore.description}</p>
                                                </div>
                                                <div className="text-right ml-4">
                                                    <div className="text-3xl font-bold text-green-600">
                                                        {chore.reward.type === 'money' ? `$${chore.currentReward}` : `${chore.currentReward}min`}
                                                    </div>
                                                    <div className="text-sm text-gray-600">
                                                        {chore.reward.type === 'money' ? 'Money 💰' : 'Screen Time 📱'}
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div className="bg-gradient-to-r from-purple-100 to-pink-100 border border-purple-200 rounded-xl p-4 mb-4">
                                                <p className="text-purple-800 font-bold text-center">
                                                    ⏰ Time to decide: {getAcceptanceTimeRemaining(chore.assignmentStartTime, chore.acceptanceTimer)}
                                                </p>
                                                {chore.completionTimer.enabled && (
                                                    <p className="text-purple-600 text-sm text-center mt-1">
                                                        Complete within {chore.completionTimer.duration}min or lose ${chore.completionTimer.penalty}
                                                    </p>
                                                )}
                                            </div>
                                            
                                            <div className="grid grid-cols-2 gap-4">
                                                <button
                                                    onClick={() => acceptChore(chore.id)}
                                                    disabled={loading}
                                                    className="bg-gradient-to-r from-green-500 to-green-600 text-white py-4 px-6 rounded-xl hover:from-green-600 hover:to-green-700 flex items-center justify-center font-bold text-lg touch-feedback disabled:opacity-50"
                                                >
                                                    {loading ? <div className="spinner"></div> : '✅ Accept'}
                                                </button>
                                                <button
                                                    onClick={() => declineChore(chore.id)}
                                                    className="bg-gradient-to-r from-red-500 to-red-600 text-white py-4 px-6 rounded-xl hover:from-red-600 hover:to-red-700 flex items-center justify-center font-bold text-lg touch-feedback"
                                                >
                                                    ❌ Pass
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                ))}
                            </div>
                        )}

                        {/* Active Chores */}
                        {myActiveChores.length > 0 && (
                            <div className="slide-up">
                                <h2 className="text-xl font-bold text-gray-900 mb-4 flex items-center">
                                    Your Active Chores 
                                    <span className="ml-2">🎯</span>
                                </h2>
                                {myActiveChores.map(chore => (
                                    <div key={chore.id} className="bg-white rounded-2xl shadow-xl p-6 border-2 border-yellow-200 mb-4 relative overflow-hidden">
                                        <div className="absolute inset-0 bg-gradient-to-r from-yellow-50 to-orange-50 opacity-50"></div>
                                        
                                        <div className="relative z-10">
                                            <div className="flex justify-between items-start mb-4">
                                                <div className="flex-1">
                                                    <div className="flex items-center mb-2">
                                                        <h3 className="text-xl font-bold text-gray-900">{chore.title}</h3>
                                                        {chore.status === 'auto_accepted' && (
                                                            <span className="ml-2 bg-indigo-100 text-indigo-800 text-xs px-3 py-1 rounded-full font-medium">
                                                                Auto-Accepted
                                                            </span>
                                                        )}
                                                    </div>
                                                    <p className="text-gray-600">{chore.description}</p>
                                                </div>
                                                <div className="text-right ml-4">
                                                    <div className="text-3xl font-bold text-green-600">
                                                        {chore.reward.type === 'money' ? `$${chore.currentReward}` : `${chore.currentReward}min`}
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div className="space-y-3">
                                                {chore.requiresPhoto && (
                                                    <button
                                                        onClick={() => submitChoreCompletion(chore.id, true)}
                                                        className="w-full bg-gradient-to-r from-blue-500 to-blue-600 text-white py-4 rounded-xl hover:from-blue-600 hover:to-blue-700 flex items-center justify-center font-bold text-lg touch-feedback"
                                                    >
                                                        📷 Complete with Photo
                                                    </button>
                                                )}
                                                <button
                                                    onClick={() => submitChoreCompletion(chore.id, false)}
                                                    className="w-full bg-gradient-to-r from-green-500 to-green-600 text-white py-4 rounded-xl hover:from-green-600 hover:to-green-700 flex items-center justify-center font-bold text-lg touch-feedback"
                                                >
                                                    ✅ Mark Complete
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                ))}
                            </div>
                        )}

                        {/* No Chores */}
                        {myPendingChores.length === 0 && myActiveChores.length === 0 && (
                            <div className="bg-white rounded-2xl shadow-xl p-8 text-center fade-in">
                                <div className="text-8xl mb-6">😌</div>
                                <h3 className="text-2xl font-bold text-gray-900 mb-3">All caught up!</h3>
                                <p className="text-gray-600 text-lg">No chores assigned right now. Check back soon!</p>
                                <div className="mt-6 text-6xl">🎉</div>
                            </div>
                        )}
                    </div>
                </div>
            );
        }
        
        // Simplified Parent Dashboard
        if (activeView === 'parent_dashboard') {
            const nextChild = children[(lastAssignedChildIndex + 1) % children.length];
            
            return (
                <div className="min-h-screen bg-gray-50 safe-area">
                    {/* Notification */}
                    {notification && (
                        <div className={`notification ${notification.type === 'warning' ? 'bg-orange-500' : 'bg-green-500'}`}>
                            {notification.message}
                        </div>
                    )}
                    
                    {/* Header */}
                    <div className="bg-white shadow-sm p-6 ios-safe-top">
                        <div className="flex justify-between items-center mb-4">
                            <div>
                                <h1 className="text-2xl font-bold text-gray-900">Parent Dashboard</h1>
                                <p className="text-gray-600">Welcome back, {currentUser.name}</p>
                                <p className="text-sm text-indigo-600 mt-1">
                                    Next chore → <span className="font-semibold">{nextChild?.name}</span>
                                </p>
                            </div>
                        </div>
                        
                        <button
                            onClick={() => {
                                vibrate([50]);
                                setActiveView('login');
                            }}
                            className="w-full bg-gray-500 text-white py-3 rounded-xl hover:bg-gray-600 touch-feedback"
                        >
                            Switch User
                        </button>
                    </div>

                    <div className="p-4 space-y-4">
                        {/* Quick Stats */}
                        <div className="grid grid-cols-2 gap-4">
                            <div className="bg-white p-4 rounded-xl shadow-lg">
                                <p className="text-gray-600 text-sm">Total Chores</p>
                                <p className="text-2xl font-bold text-indigo-600">{chores.length}</p>
                            </div>
                            <div className="bg-white p-4 rounded-xl shadow-lg">
                                <p className="text-gray-600 text-sm">Active</p>
                                <p className="text-2xl font-bold text-green-600">
                                    {chores.filter(c => c.status === 'assigned' || c.status === 'pending_acceptance').length}
                                </p>
                            </div>
                        </div>
                        
                        {/* Chores List */}
                        <div className="space-y-4">
                            <h2 className="text-xl font-bold text-gray-900">Chores</h2>
                            {chores.map(chore => {
                                const assignedChild = users.find(u => u.id === chore.currentAssignee);
                                
                                return (
                                    <div key={chore.id} className="bg-white rounded-xl shadow-lg p-4">
                                        <div className="flex justify-between items-start mb-3">
                                            <div className="flex-1">
                                                <h3 className="font-bold text-gray-900">{chore.title}</h3>
                                                <p className="text-gray-600 text-sm">{chore.description}</p>
                                            </div>
                                            <span className={`px-3 py-1 rounded-full text-xs font-medium ${
                                                chore.status === 'available' ? 'bg-blue-100 text-blue-800' :
                                                chore.status === 'pending_acceptance' ? 'bg-orange-100 text-orange-800' :
                                                chore.status === 'assigned' ? 'bg-yellow-100 text-yellow-800' :
                                                'bg-green-100 text-green-800'
                                            }`}>
                                                {chore.status.replace('_', ' ')}
                                            </span>
                                        </div>
                                        
                                        <div className="flex justify-between items-center text-sm text-gray-600 mb-3">
                                            <span>Reward: ${chore.currentReward}</span>
                                            {assignedChild && (
                                                <span>Assigned to: {assignedChild.name}</span>
                                            )}
                                        </div>
                                        
                                        {chore.status === 'available' && (
                                            <button
                                                onClick={() => startChoreAssignment(chore.id)}
                                                className="w-full bg-indigo-600 text-white py-3 rounded-lg hover:bg-indigo-700 touch-feedback font-medium"
                                            >
                                                Start Assignment → {nextChild?.name}
                                            </button>
                                        )}
                                        
                                        {chore.status === 'pending_acceptance' && chore.assignmentStartTime && (
                                            <div className="text-center text-orange-600 font-medium">
                                                Time left: {getAcceptanceTimeRemaining(chore.assignmentStartTime, chore.acceptanceTimer)}
                                            </div>
                                        )}
                                    </div>
                                );
                            })}
                        </div>
                    </div>
                </div>
            );
        }
        
        return null;
    };

    ReactDOM.render(<ChoreApp />, document.getElementById('root'));
    
    // Register Service Worker
    if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
            navigator.serviceWorker.register('data:text/javascript;charset=utf-8,' + encodeURIComponent(`
                const CACHE_NAME = 'family-chores-v1';
                const urlsToCache = [
                    '/',
                    '/manifest.json'
                ];

                self.addEventListener('install', event => {
                    event.waitUntil(
                        caches.open(CACHE_NAME)
                            .then(cache => cache.addAll(urlsToCache))
                    );
                });

                self.addEventListener('fetch', event => {
                    event.respondWith(
                        caches.match(event.request)
                            .then(response => {
                                if (response) {
                                    return response;
                                }
                                return fetch(event.request);
                            }
                        )
                    );
                });
            `))
            .then(registration => {
                console.log('SW registered: ', registration);
            })
            .catch(registrationError => {
                console.log('SW registration failed: ', registrationError);
            });
        });
    }
</script>
```

</body>
</html>
